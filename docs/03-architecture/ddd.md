# Анализ архитектуры проекта SnapMatch в контексте DDD

## 1. Ограниченный контекст (Bounded Context)

**Resume Matching Context** — ограниченный контекст, охватывающий весь процесс обработки откликов кандидатов на вакансии и анализа их резюме.

### Основные доменные сервисы:

- **Upload Service** — приём, валидация и сохранение откликов с резюме
- **Scoring Service** — анализ резюме с помощью LLM, формирование оценки и уведомление кандидата и HR

### Инфраструктурные компоненты:

- **Kafka** — событийная интеграция между сервисами
- **MinIO** — хранение оригинальных PDF-файлов резюме
- **PostgreSQL** — хранение вакансий, откликов и результатов анализа

---

## 2. Смысловое ядро и ключевой агрегат

### Смысловое ядро (Core Domain)

Наиболее бизнес-ценная часть — **Scoring Service**, реализующий интеллектуальный анализ резюме и формирующий результат, влияющий на принятие решений HR.

### Ключевой агрегат

#### `JobApplication` — агрегат отклика кандидата на вакансию

- Создаётся при отклике кандидата
- Содержит вложенное резюме (Value Object)
- Управляет статусом отклика
- Включает результат оценки (Value Object)

---

## 3. Операции над агрегатом `JobApplication`

| Операция           | Компонент                          | Описание                                               |
|--------------------|------------------------------------|--------------------------------------------------------|
| `submitApplication`| `Resume API` + `Kafka`             | Создание отклика с резюме                              |
| `startScoring`     | `Kafka Consumer`                   | Инициация анализа после получения события              |
| `completeScoring`  | `ScoringResultProcessor` → `Status Updater` | Завершение анализа и обновление статуса       |
| `notifyResult`     | `Notifier` → `WebSocket Handler`   | Уведомление кандидата и HR о результате                |

---

## 4. Структура агрегата `JobApplication`

### Идентификаторы

- `application_id` — уникальный ID отклика
- `vacancy_id` — ID вакансии
- `candidate_id` — ID кандидата
- `session_id` — используется для WebSocket-уведомлений

### Входные данные

- PDF-файл резюме (загружается при отклике)
- Текст вакансии (через `Vacancy API`)

### Вложенные Value Objects

#### `Resume`

```kotlin
class Resume(
    val content: String,   // текстовое представление
    val fileUrl: String    // ссылка на PDF в MinIO
)
